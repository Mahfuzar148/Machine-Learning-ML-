---

# ЁЯУШ Cluster Analysis: ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржмрзНржпрж╛ржЦрзНржпрж╛

---

## ЁЯУМ 1. What is a Cluster?

ржПржХржЯрж┐ **Cluster** рж╣рж▓рзЛ ржбрзЗржЯрж╛рж░ ржПржоржи ржПржХржЯрж┐ ржЧрзБржЪрзНржЫ (set), ржпрзЗржЦрж╛ржирзЗ ржПржХржЗ ржЧрзБржЪрзНржЫрзЗрж░ ржбрзЗржЯрж╛ржЧрзБрж▓рзЛ ржкрж░рж╕рзНржкрж░рзЗрж░ рж╕ржЩрзНржЧрзЗ ржмрзЗрж╢рж┐ **similar (рж╕рж╛ржжрзГрж╢рзНржпржкрзВрж░рзНржг)** ржПржмржВ ржЕржирзНржп ржЧрзБржЪрзНржЫрзЗрж░ ржбрзЗржЯрж╛рж░ ржерзЗржХрзЗ рждрзБрж▓ржирж╛ржорзВрж▓ржХржнрж╛ржмрзЗ **dissimilar (ржмрж┐ржЪрзНржЫрж┐ржирзНржи/ржЕрж╕рж╛ржжрзГрж╢рзНржпржкрзВрж░рзНржг)**ред

* ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк: ржпржжрж┐ ржХрж┐ржЫрзБ ржЧрзНрж░рж╛рж╣ржХрзЗрж░ ржмржпрж╝рж╕ ржУ ржЖржпрж╝ ржЕржирзБржпрж╛ржпрж╝рзА рждрж╛ржжрзЗрж░ рж╢рзНрж░рзЗржгрж┐ржмржжрзНржз ржХрж░рж┐, рждрж╛рж╣рж▓рзЗ ржЫрж╛рждрзНрж░, ржЪрж╛ржХрзБрж░рж┐ржЬрзАржмрзА ржПржмржВ ржЕржмрж╕рж░ржкрзНрж░рж╛ржкрзНрждржжрзЗрж░ ржоржзрзНржпрзЗ рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХржнрж╛ржмрзЗ ржЖрж▓рж╛ржжрж╛ ржЧрзНрж░рзБржк рждрзИрж░рж┐ рж╣ржмрзЗред

---

## ЁЯФН 2. What is Cluster Analysis?

**Cluster Analysis** (ржмрж╛ **Clustering**, **Data Segmentation**) рж╣рж▓рзЛ ржПржоржи ржПржХржЯрж┐ ржкржжрзНржзрждрж┐ ржпрж╛:

* ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ **рж╕рж╛ржжрзГрж╢рзНржп (similarity)** ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗред
* рж╕рзЗржЗ ржнрж┐рждрзНрждрж┐рждрзЗ ржбрзЗржЯрж╛ржЧрзБрж▓рзЛржХрзЗ **ржЕржЯрзЛ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ ржнрж╛ржЧ ржХрж░рзЗ**ред
* ржПржЯрж┐ **Unsupervised Learning**-ржПрж░ ржПржХржЯрж┐ ржЕржВрж╢, ржпрзЗржЦрж╛ржирзЗ **рж▓рзЗржмрзЗрж▓ (labels)** ржжрзЗржУржпрж╝рж╛ ржерж╛ржХрзЗ ржирж╛ред

ЁЯУМ рж▓ржХрзНрж╖рзНржп: ржбрзЗржЯрж╛рж░ ржнрзЗрждрж░рзЗрж░ рж▓рзБржХрж╛ржирзЛ ржЧржаржи (structure) ржмрзБржЭрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рж╛ред

---

## ЁЯза 3. Unsupervised Learning

* ржПржЦрж╛ржирзЗ ржХрзЛржирзЛ **predefined class ржмрж╛ label** ржирзЗржЗред
* ржорзЗрж╢рж┐ржи **observation-ржПрж░ ржорж╛ржзрзНржпржорзЗ рж╢рзЗржЦрзЗ**ред
* Clustering рж╣рж▓рзЛ ржПржЗ ржзрж░ржирзЗрж░ рж╢рзЗржЦрж╛рж░ ржПржХржЯрж┐ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЙржжрж╛рж╣рж░ржгред

---

## ЁЯТб 4. Typical Applications of Clustering

| Application Area | Example                                                 |
| ---------------- | ------------------------------------------------------- |
| Marketing        | Customer Segmentation (ржмрж┐ржнрж┐ржирзНржи ржзрж░ржирзЗрж░ ржЧрзНрж░рж╛рж╣ржХ рж╢ржирж╛ржХрзНржд ржХрж░рж╛) |
| Retail           | Market Basket Analysis (ржПржХрж╕рж╛ржерзЗ ржХрзЛржи ржкржгрзНржп ржХрзЗржирж╛ рж╣рзЯ)        |
| Healthcare       | Patient Disease Grouping                                |
| Image Processing | Pixel-based image compression                           |
| Biology          | Genetic sequence clustering                             |

---

## ЁЯзк ржЙржжрж╛рж╣рж░ржг: Customer Segmentation using K-Means

ржЖржорж░рж╛ ржПржХржЯрж┐ ржЙржжрж╛рж╣рж░ржг ржирж┐ржЪрзНржЫрж┐ ржпрзЗржЦрж╛ржирзЗ ржПржХржЯрж┐ ржХрзЛржорзНржкрж╛ржирж┐ ржЧрзНрж░рж╛рж╣ржХржжрзЗрж░ ржмржпрж╝рж╕ ржУ ржмрж╛рж░рзНрж╖рж┐ржХ ржЖржпрж╝ ржЕржирзБржпрж╛ржпрж╝рзА рж╕рзЗржЧржорзЗржирзНржЯ ржХрж░рждрзЗ ржЪрж╛ржпрж╝ред

### тЬЕ Python Code (Using K-Means)

```python
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans

# Sample Data
data = {
    'Age': [22, 25, 47, 52, 46, 56, 55, 60, 26, 30],
    'Income': [15000, 18000, 60000, 80000, 62000, 70000, 72000, 85000, 20000, 25000]
}
df = pd.DataFrame(data)

# Apply KMeans with 3 clusters
kmeans = KMeans(n_clusters=3)
df['Cluster'] = kmeans.fit_predict(df)

# Plotting
plt.scatter(df['Age'], df['Income'], c=df['Cluster'], cmap='viridis', s=100)
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], color='red', marker='X', s=200)
plt.xlabel('Age')
plt.ylabel('Annual Income')
plt.title('Customer Segmentation using K-Means')
plt.show()
```

### ЁЯФН ржлрж▓рж╛ржлрж▓ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг:

* Cluster 0: рждрж░рзБржг ржЧрзНрж░рж╛рж╣ржХ, ржХржо ржЖржпрж╝
* Cluster 1: ржоржзрзНржпржмржпрж╝рж╕рзА ржЧрзНрж░рж╛рж╣ржХ, ржмрзЗрж╢рж┐ ржЖржпрж╝
* Cluster 2: рж╕рж┐ржирж┐ржпрж╝рж░ ржЧрзНрж░рж╛рж╣ржХ, ржорж╛ржЭрж╛рж░рж┐ ржерзЗржХрзЗ ржмрзЗрж╢рж┐ ржЖржпрж╝

---

## ЁЯОп ржЙржкрж╕ржВрж╣рж╛рж░

**Cluster Analysis** рж╣рж▓рзЛ ржбрзЗржЯрж╛ржХрзЗ рж╢рзНрж░рзЗржгрж┐ржмрж┐ржирзНржпрж╛рж╕ ржХрж░рж╛рж░ ржПржХржЯрж┐ ржЕрж╕рж╛ржзрж╛рж░ржг ржХрзМрж╢рж▓, ржпрзЗржЦрж╛ржирзЗ ржорзЗрж╢рж┐ржи ржирж┐ржЬрзЗржЗ ржбрзЗржЯрж╛рж░ ржЧржаржи ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рзЗ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░ рждрзИрж░рж┐ ржХрж░рзЗред ржПржЯрж┐ ржмрж┐рж╢рзЗрж╖ржнрж╛ржмрзЗ рж╕рж╣рж╛ржпрж╝ржХ ржпржЦржи ржЖржорж╛ржжрзЗрж░ ржХрж╛ржЫрзЗ ржкрзВрж░рзНржмржирж┐рж░рзНржзрж╛рж░рж┐ржд ржХрзНрж▓рж╛рж╕ ржмрж╛ ржЯрзНржпрж╛ржЧ ржерж╛ржХрзЗ ржирж╛ред

---

## ЁЯза рзз. Algorithm (KMeans)

### тЬЕ рж╕ржВржЬрзНржЮрж╛:

K-Means ржПржХржЯрж┐ **Unsupervised Learning Algorithm**, ржпрж╛ ржбрзЗржЯрж╛ржХрзЗ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ *K* рж╕ржВржЦрзНржпржХ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ ржмрж┐ржнржХрзНржд ржХрж░рзЗ ржжрзЗрзЯ, ржпрзЗржЦрж╛ржирзЗ ржкрзНрж░рждрж┐ржЯрж┐ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░ ржорж╛ржирзЗ ржПржХрж░ржХржо ржмрзИрж╢рж┐рж╖рзНржЯрзНржпрзЗрж░ ржбрзЗржЯрж╛ ржкрзЯрзЗржирзНржЯред

### ЁЯФБ ржзрж╛ржкрж╕ржорзВрж╣:

1. K ржорж╛ржи ржирж┐рж░рзНржзрж╛рж░ржг (ржпрзЗржоржи: 3 ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░ ржЪрж╛ржЗрж▓рзЗ K = 3)
2. K рж╕ржВржЦрзНржпржХ **initial centroids** ржПрж▓рзЛржорзЗрж▓рзЛржнрж╛ржмрзЗ ржмрзЗржЫрзЗ ржирзЗржУржпрж╝рж╛
3. ржкрзНрж░рждрж┐ржЯрж┐ ржкрзЯрзЗржирзНржЯржХрзЗ рждрж╛рж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржХрж╛ржЫрзЗрж░ centroid ржЕржирзБржпрж╛рзЯрзА ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ ржпрзБржХрзНржд ржХрж░рж╛
4. ржкрзНрж░рждрж┐ржЯрж┐ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗрж░ ржЧрзЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржирждрзБржи centroid ржирж┐рж░рзНржзрж╛рж░ржг
5. ржпрждржХрзНрж╖ржг ржирж╛ centroid ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯ, ржзрж╛ржк рзй ржУ рзк ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ рж╣рзЯ

### ЁЯМН ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг:

**ржХрж╛рж╕рзНржЯржорж╛рж░ рж╕рзЗржЧржорзЗржирзНржЯрзЗрж╢ржи:**
ржПржХржЯрж┐ рж╕рзБржкрж╛рж░рж╢ржк рждрж╛рж░ ржХрзНрж░рзЗрждрж╛ржжрзЗрж░ ржмрзЯрж╕ ржПржмржВ ржЦрж░ржЪрзЗрж░ ржкрж░рж┐ржорж╛ржгрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рзй ржзрж░ржирзЗрж░ ржЧрзНрж░рзБржкрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржЪрж╛рзЯ:

* Cluster 1: ржЫрж╛рждрзНрж░ (ржЕрж▓рзНржк ржЦрж░ржЪ)
* Cluster 2: ржоржзрзНржпржмрзЯрж╕рзА ржкрж░рж┐ржмрж╛рж░ (ржорж╛ржЭрж╛рж░рж┐ ржЦрж░ржЪ)
* Cluster 3: ржзржирзА ржХрж╛рж╕рзНржЯржорж╛рж░ (ржмрзЗрж╢рж┐ ржЦрж░ржЪ)

---

## ЁЯУП рзи. Metrics

### ЁЯФ╣ рзз. Euclidean Distance

#### тЮХ рж╕ржВржЬрзНржЮрж╛:

ржжрзБржЯрж┐ ржкрзЯрзЗржирзНржЯрзЗрж░ рж╕рж░рж▓рж░рзЗржЦрж╛рж░ ржжрзВрж░рждрзНржмред
**Formula:**

$$
\sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}
$$

#### ЁЯЫая╕П ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг:

Customer A: (age 25, spending 400)
Customer B: (age 30, spending 420)

Euclidean distance:

$$
\sqrt{(30-25)^2 + (420-400)^2} = \sqrt{25 + 400} = \sqrt{425} \approx 20.61
$$

ржПржЗ ржжрзВрж░рждрзНржм ржХржо рж╣рж▓рзЗ, рждрж╛рж░рж╛ ржПржХржЗ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ ржпрж╛ржмрзЗред

---

### ЁЯФ╣ рзи. Manhattan Distance

#### тЮХ рж╕ржВржЬрзНржЮрж╛:

ржжрзБржЯрж┐ ржкржпрж╝рзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ **ржЕржирзБржнрзВржорж┐ржХ ржУ ржЙрж▓рзНрж▓ржорзНржм** ржжрзВрж░рждрзНржмрзЗрж░ ржпрзЛржЧржлрж▓ред
**Formula:**

$$
|x_2 - x_1| + |y_2 - y_1|
$$

#### ЁЯЫая╕П ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг:

Customer A: (25, 400)
Customer B: (30, 420)

Manhattan Distance:

$$
|30-25| + |420-400| = 5 + 20 = 25
$$

ЁЯУМ ржПржЯрж┐ ржЖржЙржЯрж▓рж╛ржпрж╝рж╛рж░ рж╕рзЗржирж╕рж┐ржЯрж┐ржн ржирзЯ ржПржмржВ ржЬржЯрж┐рж▓ рж╢рж╣рзБрж░рзЗ ржЧрзНрж░рж┐ржбрзЗ ржХрж╛рж░рзНржпржХрж░ред

---

## ЁЯУЙ рзй. Elbow Method

### ЁЯФН ржЙржжрзНржжрзЗрж╢рзНржп:

ржЙрждрзНрждржо K ржорж╛ржи (ржХрждржЯрж┐ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░ ржирзЗржмрзЗржи) ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рж╛ред

### ЁЯкЬ ржзрж╛ржкрж╕ржорзВрж╣:

1. ржмрж┐ржнрж┐ржирзНржи K ржорж╛ржи (1 ржерзЗржХрзЗ 10) ржжрж┐ржпрж╝рзЗ KMeans ржЪрж╛рж▓рж╛ржирзЛ
2. ржкрзНрж░рждрж┐ржЯрж┐ K-рждрзЗ **Within-Cluster-Sum-of-Squares (WCSS)** рж╣рж┐рж╕рж╛ржм ржХрж░рж╛
3. WCSS ржмржирж╛ржо K-ржПрж░ ржЧрзНрж░рж╛ржл ржЖржБржХрж╛
4. ржпрзЗржЦрж╛ржирзЗ рж╣ржарж╛рзО ржХрж░рзЗ WCSS ржХржорж╛рж░ рж╣рж╛рж░ ржХржорзЗ ржпрж╛ржпрж╝, рж╕рзЗржЗ ржкрзЯрзЗржирзНржЯрзЗ тАЬelbowтАЭ ржжрзЗржЦрж╛ ржпрж╛ржпрж╝ тЖТ ржПржЯрж┐ржЗ рж╕рзЗрж░рж╛ K

### ЁЯУК ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг:

ржХрзЛржирзЛ ржЗ-ржХржорж╛рж░рзНрж╕ рж╕рж╛ржЗржЯрзЗ рзлрзжрзж ржХрж╛рж╕рзНржЯржорж╛рж░ ржЖржЫрзЗред рждрж╛рж░рж╛ K=1 ржерзЗржХрзЗ K=10 ржкрж░рзНржпржирзНржд ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗ ржжрзЗржЦрзЗ:

* K=1: WCSS = 12000
* K=2: 7000
* K=3: 3500
* K=4: 1800
* K=5: 1700

ржПржЦрж╛ржирзЗ Elbow point K=4, ржХрж╛рж░ржг рждрж╛рж░ ржкрж░ WCSS ржЦрзБржм ржХржо рж╣рж╛рж░рзЗ ржХржоржЫрзЗред

ЁЯУМ **Python Implementation:**

```python
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt

wcss = []
for i in range(1, 11):
    kmeans = KMeans(n_clusters=i, random_state=0)
    kmeans.fit(data)
    wcss.append(kmeans.inertia_)

plt.plot(range(1, 11), wcss, marker='o')
plt.title('Elbow Method')
plt.xlabel('Clusters (K)')
plt.ylabel('WCSS')
plt.show()
```

---

## ЁЯОп рж╕рж╛рж░рж╛ржВрж╢ ржЯрзЗржмрж┐рж▓:

| ржмрж┐рж╖ржпрж╝              | ржмрзНржпрж╛ржЦрзНржпрж╛                           | ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг                         |
| ------------------ | ---------------------------------- | ------------------------------------- |
| Algorithm          | ржбрзЗржЯрж╛ржХрзЗ K рж╕ржВржЦрзНржпржХ ржХрзНрж▓рж╛рж╕рзНржЯрж╛рж░рзЗ ржнрж╛ржЧ ржХрж░рж╛ | ржХрж╛рж╕рзНржЯржорж╛рж░ ржЧрзНрж░рзБржкрж┐ржВ                      |
| Euclidean Distance | рж╕рж░рж▓рж░рзЗржЦрж╛рж░ ржжрзВрж░рждрзНржм                    | ржмржпрж╝рж╕ ржУ ржЦрж░ржЪрзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржХрж╛рж╕рзНржЯржорж╛рж░ ржжрзВрж░рждрзНржм |
| Manhattan Distance | ржЕржирзБржнрзВржорж┐ржХ ржУ ржЙрж▓рзНрж▓ржорзНржм ржжрзВрж░рждрзНржмрзЗрж░ ржпрзЛржЧ    | рж╢рж╣рж░рзЗрж░ рж░рж╛рж╕рзНрждрж╛ржпрж╝ ржирзЗржнрж┐ржЧрзЗрж╢ржи               |
| Elbow Method       | рж╕ржарж┐ржХ K ржирж┐рж░рзНржзрж╛рж░ржг                    | рж╕рзБржкрж╛рж░рж╢ржкрзЗ ржХржд ржзрж░ржирзЗрж░ ржЧрзНрж░рж╛рж╣ржХ ржЖржЫрзЗ ржмрзБржЭрждрзЗ    |

---
